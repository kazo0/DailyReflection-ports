<?xml version="1.0" encoding="utf-8"?>
<!--
    SobrietyTimePage
    Migrated from MAUI SobrietyTimeView.xaml to WinUI/Uno Platform Page
    
    Control Mappings:
    - ContentPage -> Page
    - Label -> TextBlock
    - HorizontalOptions -> HorizontalAlignment
    - VerticalOptions -> VerticalAlignment
    - IsVisible -> Visibility (with converter)
    - StringFormat removed (use Run elements or code functions)
    - x:Static -> x:Bind to static properties
-->
<Page x:Class="DailyReflection.Views.SobrietyTimePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:converters="using:DailyReflection.Converters"
      xmlns:models="using:DailyReflection.Data.Models"
      xmlns:vm="using:DailyReflection.Presentation.ViewModels"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <converters:PluralityConverter x:Key="YearsPluralityConverter"
                                        PluralValue="Years"
                                        SingularValue="Year" />
        <converters:PluralityConverter x:Key="MonthsPluralityConverter"
                                        PluralValue="Months"
                                        SingularValue="Month" />
        <converters:PluralityConverter x:Key="DaysPluralityConverter"
                                        PluralValue="Days"
                                        SingularValue="Day" />
        <converters:IsDisplayPreferenceToBoolConverter x:Key="IsDaysMonthsYearsDisplayPreferenceConverter"
                                                        DisplayPreferenceString="DaysMonthsYears" />
        <converters:IsDisplayPreferenceToBoolConverter x:Key="IsDaysOnlyDisplayPreferenceConverter"
                                                        DisplayPreferenceString="DaysOnly" />
    </Page.Resources>
    
    <ScrollViewer>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="20" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Sober Date Display -->
            <Grid Grid.Row="1"
                  Visibility="{x:Bind ViewModel.SoberDate, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                
                <!-- Calendar Icon -->
                <FontIcon FontFamily="{StaticResource FontAwesomeRegular}"
                          Glyph="&#xf073;"
                          FontSize="28"
                          HorizontalAlignment="Center" />
                
                <!-- Formatted Date -->
                <TextBlock Grid.Row="1"
                           Style="{StaticResource TitleTextStyle}"
                           HorizontalAlignment="Center"
                           Text="{x:Bind FormatSoberDate(ViewModel.SoberDate), Mode=OneWay}" />
            </Grid>

            <!-- Sober Period Display (conditional based on preference) -->
            <Grid Grid.Row="3"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Visibility="{x:Bind ViewModel.SoberDate, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}">
                
                <!-- Days/Months/Years Display Mode -->
                <Grid ColumnSpacing="16"
                      Visibility="{x:Bind ViewModel.DisplayPreference, Mode=OneWay, Converter={StaticResource IsDaysMonthsYearsDisplayPreferenceConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!-- Years -->
                    <TextBlock Style="{StaticResource TitleTextStyle}"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Years, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Years, Mode=OneWay}" />
                    <TextBlock Grid.Column="1"
                               Style="{StaticResource TitleTextStyle}"
                               HorizontalAlignment="Left"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Years, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Years, Mode=OneWay, Converter={StaticResource YearsPluralityConverter}}" />

                    <!-- Months -->
                    <TextBlock Grid.Row="1"
                               Style="{StaticResource TitleTextStyle}"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Months, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Months, Mode=OneWay}" />
                    <TextBlock Grid.Row="1"
                               Grid.Column="1"
                               Style="{StaticResource TitleTextStyle}"
                               HorizontalAlignment="Left"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Months, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Months, Mode=OneWay, Converter={StaticResource MonthsPluralityConverter}}" />

                    <!-- Days -->
                    <TextBlock Grid.Row="2"
                               Style="{StaticResource TitleTextStyle}"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Days, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Days, Mode=OneWay}" />
                    <TextBlock Grid.Row="2"
                               Grid.Column="1"
                               Style="{StaticResource TitleTextStyle}"
                               HorizontalAlignment="Left"
                               Visibility="{x:Bind ViewModel.SoberPeriod.Days, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.SoberPeriod.Days, Mode=OneWay, Converter={StaticResource DaysPluralityConverter}}" />
                </Grid>

                <!-- Days Only Display Mode -->
                <Grid ColumnSpacing="16"
                      Visibility="{x:Bind ViewModel.DisplayPreference, Mode=OneWay, Converter={StaticResource IsDaysOnlyDisplayPreferenceConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Style="{StaticResource TitleTextStyle}"
                               Visibility="{x:Bind ViewModel.TotalDaysSober, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.TotalDaysSober, Mode=OneWay}" />
                    <TextBlock Grid.Column="1"
                               Style="{StaticResource TitleTextStyle}"
                               HorizontalAlignment="Left"
                               Visibility="{x:Bind ViewModel.TotalDaysSober, Mode=OneWay, Converter={StaticResource IntToBoolConverter}}"
                               Text="{x:Bind ViewModel.TotalDaysSober, Mode=OneWay, Converter={StaticResource DaysPluralityConverter}}" />
                </Grid>
            </Grid>

            <!-- "One day at a time" text -->
            <TextBlock Grid.Row="4"
                       Style="{StaticResource SubtitleTextStyle}"
                       FontStyle="Italic"
                       HorizontalAlignment="Center"
                       Text="One day at a time" />
        </Grid>
    </ScrollViewer>
</Page>